veil.event.EVENT_DIALOG_INIT="init.dialog",veil.event.EVENT_DIALOG_CLOSING="closing.dialog",function(t){var o={cache:void 0,model:!1,showClose:!0,content:"",width:"auto",height:"auto",left:"",right:"",top:"",draggable:!1,setFocus:!1,beforeShow:function(){},onShown:function(){},onClosed:function(){}};t.showDialog=function(e){function n(){0==t("#dialog-overlay").length&&t("body").append('<div id="dialog-overlay" style="display:none"></div>'),m(),t("#dialog-overlay").show()}function i(){0==t("#dialog-box").length&&t("body").append(E),l(),u(),s(),o.draggable&&t("#dialog-box").draggable(),veil.event.publish(veil.event.EVENT_DIALOG_INIT),o.beforeShow(t("#dialog-box")),t("#dialog-box").fadeIn(500,function(){o.onShown(t("#dialog-box"))})}function c(){t("#dialog-box-content input:enabled:text:visible:first").focus()}function l(){var o=t("#dialog-box-content"),e=a();o.html(e)}function a(){var e=o.content;if(e.jquery)return e;if(o.content.match(/^\//))e=d(o.content);else if(o.content.match(/^#/)){var n=o.content;e=t(n),e.show()}return e}function d(e){var n="",i={url:e,async:!1,success:function(t){n=t},statusCode:{403:function(t){n=t.responseText}}};return void 0!==o.cache&&(i.cache=o.cache),t.ajax(i),n}function s(){o.showClose?t("#dialog-close-button").show():t("#dialog-close-button").hide()}function u(){var o=t("#dialog-box");v(o),f(o)}function f(t){r()?g(t):h(t)}function r(){return""===o.top}function g(o){var e=t(document).scrollTop()+(t(window).height()-o.height())/2,n=(t(window).width()-o.width())/2;o.css({left:n,top:e})}function h(e){var n=o.top-e.height()/2;20>n&&(n=(t(window).height()-e.height())/3),""!==o.left?e.css({left:o.left,top:n}):""!==o.right?e.css({left:o.right-e.outerWidth(),top:n}):alert("Must assign left/right position when popup dialog defined top position.")}function v(t){t.css("width",o.width),t.css("height",o.height)}function m(){var o=t("#dialog-overlay");o.width(b()),o.height(p())}function b(){var t=document;return Math.max(Math.max(t.body.scrollWidth,t.documentElement.scrollWidth),Math.max(t.body.offsetWidth,t.documentElement.offsetWidth),Math.max(t.body.clientWidth,t.documentElement.clientWidth))}function p(){var t=document;return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}function w(){x(),y()}function x(){t(window).resize(function(){m()})}function y(){o.model||t("#dialog-overlay").click(function(){t.closeDialog()}),t(document).on("click","#dialog-close-button, .close-dialog",function(){t.closeDialog()})}var E='<div id="dialog-box" style="display:none"><img id="dialog-close-button" src="/static/dialog/dialog-close.gif"><div id="dialog-box-content"></div> </div>';e&&t.extend(o,e),n(),i(),w(),o.setFocus&&c()},t.closeDialog=function(){veil.event.publish(veil.event.EVENT_DIALOG_CLOSING),t("#dialog-box").fadeOut(500,function(){"use strict";o.onClosed()}),t("#dialog-overlay").fadeOut(500)}}(jQuery),function(t){t.confirm=function(o){function e(){t("#confirm-ok").click(function(){i.ok(),t.closeDialog()}),t("#confirm-cancel").click(function(){i.cancel(),t.closeDialog()})}function n(){i.cancel()}var i={message:"Are you sure?",ok:function(){},cancel:function(){}};o&&t.extend(i,o),veil.event.subscribe(veil.event.EVENT_DIALOG_INIT,e),veil.event.subscribe(veil.event.EVENT_DIALOG_CLOSING,n);var c='<img src="/static/dialog/dialog-warning.gif"><p class="confirm-content">'+i.message+'</p><fieldset><button id="confirm-ok">确定</button><button id="confirm-cancel">取消</button></fieldset>';t.showDialog({content:c,model:!0,width:"300px"})}}(jQuery),function(t){t.alert=function(o){function e(){t("#confirm-ok").click(function(){i.ok(),t.closeDialog()})}function n(){i.cancel()}var i={message:"Alert!",ok:function(){}};o&&t.extend(i,o),veil.event.subscribe(veil.event.EVENT_DIALOG_INIT,e),veil.event.subscribe(veil.event.EVENT_DIALOG_CLOSING,n);var c='<img src="/static/dialog/dialog-warning.gif"><p class="confirm-content">'+i.message+'</p><fieldset><button id="confirm-ok">OK</button></fieldset>';t.showDialog({content:c,model:!0,width:"300px"})}}(jQuery),POPUP_AT_LEFT="left",POPUP_AT_RIGHT="right",function(t){t.popup=function(o,e,n){function i(){var t="",e="",i=o.position().top+o.outerHeight()/2;return n===POPUP_AT_LEFT?e=o.position().left-20:t=o.position().left+o.outerWidth()+20,{left:t,top:i,right:e}}var c=i();t.showDialog({content:e,model:!1,left:c.left,right:c.right,top:c.top})}}(jQuery);